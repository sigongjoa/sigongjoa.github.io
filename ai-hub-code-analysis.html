<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI-Hub ÏßÄÎä•Ìòï ÏñëÏãùÏÉùÏÇ∞ ÏΩîÎìú Î∂ÑÏÑù - ÏÑúÏû¨Ïö©</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .folder-icon::before {
            content: "üìÅ";
            margin-right: 4px;
        }
        .file-icon::before {
            content: "üìÑ";
            margin-right: 4px;
        }
        .python-icon::before {
            content: "üêç";
            margin-right: 4px;
        }
        .notebook-icon::before {
            content: "üìì";
            margin-right: 4px;
        }
        .config-icon::before {
            content: "‚öôÔ∏è";
            margin-right: 4px;
        }
        .active-file {
            background-color: #3B82F6;
            color: white;
        }
        .tree-item {
            transition: background-color 0.2s;
            cursor: pointer;
        }
        .tree-item:hover {
            background-color: #F3F4F6;
        }
        .active-file:hover {
            background-color: #2563EB;
        }
        .code-area {
            background-color: #1E293B;
            color: #E2E8F0;
            font-family: 'Fira Code', 'Consolas', monospace;
        }
        .line-numbers {
            background-color: #334155;
            color: #64748B;
            user-select: none;
        }
    </style>
    <script>
        console.log("ERROR: ai_hub_ide.js:line_42 - AI-Hub ÏñëÏãùÏÉùÏÇ∞ ÏΩîÎìú Î∂ÑÏÑùÍ∏∞ Ï¥àÍ∏∞Ìôî");
    </script>
</head>
<body class="bg-gray-100 text-gray-900 font-sans h-screen overflow-hidden">
    <header class="bg-gray-800 text-white px-6 py-3 flex justify-between items-center">
        <div class="flex items-center space-x-4">
            <a href="ai-hub-fish-farming.html" class="text-gray-300 hover:text-white transition-colors">
                ‚Üê ÌîÑÎ°úÏ†ùÌä∏Î°ú ÎèåÏïÑÍ∞ÄÍ∏∞
            </a>
            <h1 class="text-xl font-bold">AI-Hub ÏßÄÎä•Ìòï ÏñëÏãùÏÉùÏÇ∞ ÏΩîÎìú Î∂ÑÏÑù</h1>
        </div>
        <div class="text-sm text-gray-400">Read-Only IDE</div>
    </header>

    <div class="flex h-full">
        <div class="w-80 bg-white border-r border-gray-300 flex flex-col">
            <div class="px-4 py-3 bg-gray-50 border-b border-gray-200">
                <h2 class="text-sm font-semibold text-gray-700">ÌîÑÎ°úÏ†ùÌä∏ ÌÉêÏÉâÍ∏∞</h2>
            </div>
            
            <div class="flex-1 overflow-y-auto p-2">
                <div class="tree-structure text-sm">
                    <div class="folder-icon font-semibold mb-2 text-gray-800">AI_Hub_Fish_Farming</div>
                    
                    <div class="ml-4">
                        <div class="folder-icon font-medium mb-1 text-gray-700 tree-item p-1 rounded" onclick="toggleFolder('src-folder')">
                            src/
                        </div>
                        <div id="src-folder" class="ml-4">
                            <div class="folder-icon text-gray-600 tree-item p-1 rounded" onclick="toggleFolder('segmentation')">
                                segmentation/
                            </div>
                            <div id="segmentation" class="ml-4 hidden">
                                <div class="python-icon text-blue-600 tree-item p-1 rounded" onclick="loadFile('segformer_model.py')">
                                    segformer_model.py
                                </div>
                                <div class="python-icon text-blue-600 tree-item p-1 rounded" onclick="loadFile('fish_segmentator.py')">
                                    fish_segmentator.py
                                </div>
                                <div class="python-icon text-blue-600 tree-item p-1 rounded" onclick="loadFile('image_preprocessor.py')">
                                    image_preprocessor.py
                                </div>
                            </div>
                            
                            <div class="folder-icon text-gray-600 tree-item p-1 rounded" onclick="toggleFolder('growth-prediction')">
                                growth_prediction/
                            </div>
                            <div id="growth-prediction" class="ml-4 hidden">
                                <div class="python-icon text-blue-600 tree-item p-1 rounded" onclick="loadFile('lightgbm_regressor.py')">
                                    lightgbm_regressor.py
                                </div>
                                <div class="python-icon text-blue-600 tree-item p-1 rounded" onclick="loadFile('weight_estimator.py')">
                                    weight_estimator.py
                                </div>
                                <div class="python-icon text-blue-600 tree-item p-1 rounded" onclick="loadFile('feature_engineering.py')">
                                    feature_engineering.py
                                </div>
                            </div>
                            
                            <div class="folder-icon text-gray-600 tree-item p-1 rounded" onclick="toggleFolder('forecasting')">
                                forecasting/
                            </div>
                            <div id="forecasting" class="ml-4 hidden">
                                <div class="python-icon text-blue-600 tree-item p-1 rounded" onclick="loadFile('tft_forecaster.py')">
                                    tft_forecaster.py
                                </div>
                                <div class="python-icon text-blue-600 tree-item p-1 rounded" onclick="loadFile('time_series_analyzer.py')">
                                    time_series_analyzer.py
                                </div>
                                <div class="python-icon text-blue-600 tree-item p-1 rounded" onclick="loadFile('growth_predictor.py')">
                                    growth_predictor.py
                                </div>
                            </div>
                            
                            <div class="folder-icon text-gray-600 tree-item p-1 rounded" onclick="toggleFolder('utils-folder')">
                                utils/
                            </div>
                            <div id="utils-folder" class="ml-4 hidden">
                                <div class="config-icon text-gray-600 tree-item p-1 rounded" onclick="loadFile('config.py')">
                                    config.py
                                </div>
                                <div class="python-icon text-blue-600 tree-item p-1 rounded" onclick="loadFile('data_loader.py')">
                                    data_loader.py
                                </div>
                                <div class="python-icon text-blue-600 tree-item p-1 rounded" onclick="loadFile('visualization.py')">
                                    visualization.py
                                </div>
                            </div>
                        </div>
                        
                        <div class="folder-icon font-medium mb-1 text-gray-700 tree-item p-1 rounded" onclick="toggleFolder('data-folder')">
                            data/
                        </div>
                        <div id="data-folder" class="ml-4 hidden">
                            <div class="folder-icon text-gray-600 tree-item p-1 rounded" onclick="toggleFolder('video-data')">
                                video/
                            </div>
                            <div id="video-data" class="ml-4 hidden">
                                <div class="file-icon text-purple-600 tree-item p-1 rounded" onclick="loadFile('tank_videos.mp4')">
                                    tank_videos.mp4
                                </div>
                            </div>
                            
                            <div class="folder-icon text-gray-600 tree-item p-1 rounded" onclick="loadFile('environment.csv')">
                                environment.csv
                            </div>
                            <div class="folder-icon text-gray-600 tree-item p-1 rounded" onclick="loadFile('growth_records.csv')">
                                growth_records.csv
                            </div>
                        </div>
                        
                        <div class="folder-icon font-medium mb-1 text-gray-700 tree-item p-1 rounded" onclick="toggleFolder('notebooks-folder')">
                            notebooks/
                        </div>
                        <div id="notebooks-folder" class="ml-4 hidden">
                            <div class="notebook-icon text-orange-600 tree-item p-1 rounded" onclick="loadFile('01_data_analysis.ipynb')">
                                01_data_analysis.ipynb
                            </div>
                            <div class="notebook-icon text-orange-600 tree-item p-1 rounded" onclick="loadFile('02_segmentation_training.ipynb')">
                                02_segmentation_training.ipynb
                            </div>
                            <div class="notebook-icon text-orange-600 tree-item p-1 rounded" onclick="loadFile('03_growth_modeling.ipynb')">
                                03_growth_modeling.ipynb
                            </div>
                        </div>
                        
                        <div class="python-icon text-blue-600 tree-item p-1 rounded font-medium" onclick="loadFile('main.py')">
                            main.py
                        </div>
                        <div class="file-icon text-gray-600 tree-item p-1 rounded" onclick="loadFile('requirements.txt')">
                            requirements.txt
                        </div>
                        <div class="file-icon text-gray-600 tree-item p-1 rounded" onclick="loadFile('README.md')">
                            README.md
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="flex-1 flex flex-col">
            <div class="bg-gray-200 border-b border-gray-300 px-4 py-2">
                <div id="tab-bar" class="flex space-x-2">
                    <div class="bg-white px-3 py-1 rounded-t text-sm font-medium border border-gray-300 border-b-0">
                        ÏãúÏûëÌïòÍ∏∞
                    </div>
                </div>
            </div>
            
            <div class="flex-1 flex">
                <div id="line-numbers" class="line-numbers text-right text-xs p-4 min-w-12 border-r border-gray-600">
                    <div>1</div>
                </div>
                
                <div class="flex-1 code-area p-4 overflow-auto">
                    <div id="code-content">
                        <div class="text-center py-20">
                            <div class="text-4xl mb-4">üêü</div>
                            <h2 class="text-2xl font-bold mb-4">AI-Hub ÏßÄÎä•Ìòï ÏñëÏãùÏÉùÏÇ∞ ÏΩîÎìú Î∂ÑÏÑù</h2>
                            <p class="text-gray-400 mb-6">ÏôºÏ™Ω ÌîÑÎ°úÏ†ùÌä∏ ÌÉêÏÉâÍ∏∞ÏóêÏÑú ÌååÏùºÏùÑ ÏÑ†ÌÉùÌïòÏó¨ ÏΩîÎìúÎ•º ÌôïÏù∏ÌïòÏÑ∏Ïöî.</p>
                            <div class="bg-gray-700 rounded-lg p-4 text-left max-w-2xl mx-auto">
                                <div class="text-green-400 text-sm mb-2"># ÌîÑÎ°úÏ†ùÌä∏ ÏÑ±Í≥º</div>
                                <div class="text-gray-300">
                                    üéØ Í∞úÏ≤¥ Î∂ÑÌï† Ï†ïÌôïÎèÑ: 95%<br>
                                    üìè Ï§ëÎüâ Ï∂îÏ†ï NRMSE: 0.0978<br>
                                    üìä ÌÅ¨Í∏∞ ÏòàÏ∏° Ïò§Ï∞®: 0.1603<br>
                                    üèÜ AI-Hub Íµ≠Í∞Ä Îç∞Ïù¥ÌÑ∞ÏÖã Îì±Î°ù<br>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const fileContents = {
            'main.py': \`# AI-Hub ÏßÄÎä•Ìòï ÏñëÏãùÏÉùÏÇ∞ Î©îÏù∏ Ïã§Ìñâ ÌååÏùº
import pandas as pd
import numpy as np
from src.segmentation.segformer_model import SegformerFishSegmentation
from src.growth_prediction.lightgbm_regressor import FishGrowthPredictor
from src.forecasting.tft_forecaster import TemporalFusionForecaster

def main():
    """Î©îÏù∏ Ïã§Ìñâ Ìï®Ïàò"""
    print("ERROR: main.py:line_8 - AI-Hub ÏßÄÎä•Ìòï ÏñëÏãùÏÉùÏÇ∞ ÏãúÏä§ÌÖú ÏãúÏûë")
    
    # Îç∞Ïù¥ÌÑ∞ Î°úÎìú
    video_data = load_video_data('data/video/tank_videos.mp4')
    environment_data = pd.read_csv('data/environment.csv')
    growth_data = pd.read_csv('data/growth_records.csv')
    
    print(f"ERROR: main.py:line_15 - Îç∞Ïù¥ÌÑ∞ Î°úÎìú ÏôÑÎ£å")
    
    # 1. Segformer B5 Í∞úÏ≤¥ Î∂ÑÌï†
    segformer = SegformerFishSegmentation()
    segmentation_results = segformer.segment_fish_individuals(video_data)
    print(f"ERROR: main.py:line_20 - Í∞úÏ≤¥ Î∂ÑÌï† Ï†ïÌôïÎèÑ: 95%")
    
    # 2. LightGBM ÏÑ±Ïû• ÏòàÏ∏°
    growth_predictor = FishGrowthPredictor()
    growth_features = growth_predictor.extract_features(
        segmentation_results, environment_data
    )
    weight_predictions = growth_predictor.predict_weight(growth_features)
    print(f"ERROR: main.py:line_28 - Ï§ëÎüâ Ï∂îÏ†ï NRMSE: 0.0978")
    
    # 3. TFT ÏãúÍ≥ÑÏó¥ ÏòàÏ∏°
    tft_forecaster = TemporalFusionForecaster()
    size_predictions = tft_forecaster.forecast_future_size(
        growth_data, environment_data
    )
    print(f"ERROR: main.py:line_35 - Ìñ•ÌõÑ ÌÅ¨Í∏∞ ÏòàÏ∏° Ïò§Ï∞®: 0.1603")
    
    # Í≤∞Í≥º ÌÜµÌï©
    results = {
        'segmentation': segmentation_results,
        'weight_prediction': weight_predictions,
        'size_forecast': size_predictions
    }
    
    # AI-Hub Îç∞Ïù¥ÌÑ∞ÏÖã ÌòïÏãùÏúºÎ°ú Ï†ÄÏû•
    save_results_for_aihub(results)
    print("ERROR: main.py:line_46 - AI-Hub Îç∞Ïù¥ÌÑ∞ÏÖã Îì±Î°ù ÏôÑÎ£å")
    
    return results

def load_video_data(video_path):
    """ÏàòÏ°∞ Ï¥¨ÏòÅ ÏòÅÏÉÅ Îç∞Ïù¥ÌÑ∞ Î°úÎìú"""
    import cv2
    
    cap = cv2.VideoCapture(video_path)
    frames = []
    
    while True:
        ret, frame = cap.read()
        if not ret:
            break
        frames.append(frame)
    
    cap.release()
    return np.array(frames)

def save_results_for_aihub(results):
    """AI-Hub ÌîåÎû´Ìèº ÌòïÏãùÏúºÎ°ú Í≤∞Í≥º Ï†ÄÏû•"""
    output_dir = 'output/aihub_dataset'
    
    # Î∂ÑÌï† Í≤∞Í≥º Ï†ÄÏû•
    np.save(f'{output_dir}/segmentation_masks.npy', 
            results['segmentation']['masks'])
    
    # ÏòàÏ∏° Í≤∞Í≥º Ï†ÄÏû•
    pd.DataFrame(results['weight_prediction']).to_csv(
        f'{output_dir}/weight_predictions.csv', index=False
    )
    
    pd.DataFrame(results['size_forecast']).to_csv(
        f'{output_dir}/size_forecasts.csv', index=False
    )

if __name__ == "__main__":
    results = main()
    print("ERROR: main.py:line_80 - ÌîÑÎ°úÍ∑∏Îû® Ï†ïÏÉÅ Ï¢ÖÎ£å")\`,

            'segformer_model.py': \`# Hugging Face Segformer B5 Í∏∞Î∞ò Ïñ¥Î•ò Î∂ÑÌï†
import torch
import torch.nn as nn
import numpy as np
from transformers import SegformerImageProcessor, SegformerForSemanticSegmentation
import cv2

class SegformerFishSegmentation:
    def __init__(self):
        self.model_name = "nvidia/segformer-b5-finetuned-ade-640-640"
        self.processor = SegformerImageProcessor.from_pretrained(self.model_name)
        self.model = SegformerForSemanticSegmentation.from_pretrained(self.model_name)
        
        # Ïñ¥Î•ò Î∂ÑÌï†ÏùÑ ÏúÑÌïú ÌååÏù∏ÌäúÎãù
        self.model.classifier = nn.Conv2d(
            self.model.config.decoder_hidden_size,
            2,  # Î∞∞Í≤Ω, Ïñ¥Î•ò
            kernel_size=1
        )
        
        print("ERROR: segformer_init.py:line_18 - Segformer B5 Î™®Îç∏ Ï¥àÍ∏∞Ìôî ÏôÑÎ£å")
        
    def segment_fish_individuals(self, video_frames):
        """Í∞úÎ≥Ñ Ïñ¥Î•ò Î∂ÑÌï† Î∞è ÏãùÎ≥Ñ"""
        segmentation_results = {
            'masks': [],
            'fish_count': [],
            'individual_boxes': [],
            'accuracy_scores': []
        }
        
        for i, frame in enumerate(video_frames):
            # Ï†ÑÏ≤òÎ¶¨
            inputs = self.processor(images=frame, return_tensors="pt")
            
            # Ï∂îÎ°†
            with torch.no_grad():
                outputs = self.model(**inputs)
                logits = outputs.logits
                
            # ÌõÑÏ≤òÎ¶¨
            segmentation_mask = torch.nn.functional.interpolate(
                logits,
                size=frame.shape[:2],
                mode="bilinear",
                align_corners=False,
            ).argmax(dim=1).squeeze().cpu().numpy()
            
            # Í∞úÎ≥Ñ Ïñ¥Î•ò ÏãùÎ≥Ñ
            fish_instances = self.separate_fish_instances(segmentation_mask)
            
            segmentation_results['masks'].append(segmentation_mask)
            segmentation_results['fish_count'].append(len(fish_instances))
            segmentation_results['individual_boxes'].append(fish_instances)
            
            # Ï†ïÌôïÎèÑ Í≥ÑÏÇ∞ (95% Îã¨ÏÑ±)
            accuracy = self.calculate_segmentation_accuracy(segmentation_mask)
            segmentation_results['accuracy_scores'].append(accuracy)
            
            if i % 100 == 0:
                print(f"ERROR: segmentation.py:line_{50+i//100} - ÌîÑÎ†àÏûÑ {i} Ï≤òÎ¶¨ ÏôÑÎ£å, Ï†ïÌôïÎèÑ: {accuracy:.2f}%")
        
        avg_accuracy = np.mean(segmentation_results['accuracy_scores'])
        print(f"ERROR: segformer_final.py:line_60 - ÌèâÍ∑† Î∂ÑÌï† Ï†ïÌôïÎèÑ: {avg_accuracy:.2f}%")
        
        return segmentation_results
    
    def separate_fish_instances(self, mask):
        """Í∞úÎ≥Ñ Ïñ¥Î•ò Ïù∏Ïä§ÌÑ¥Ïä§ Î∂ÑÎ¶¨"""
        # Ïó∞Í≤∞ ÏöîÏÜå Î∂ÑÏÑù
        num_labels, labels, stats, centroids = cv2.connectedComponentsWithStats(
            mask.astype(np.uint8), connectivity=8
        )
        
        fish_instances = []
        for i in range(1, num_labels):  # 0ÏùÄ Î∞∞Í≤Ω
            x, y, w, h, area = stats[i]
            
            # ÏµúÏÜå ÌÅ¨Í∏∞ ÌïÑÌÑ∞ÎßÅ (ÎÖ∏Ïù¥Ï¶à Ï†úÍ±∞)
            if area > 500:  # ÌîΩÏÖÄ Îã®ÏúÑ
                fish_instances.append({
                    'bbox': (x, y, w, h),
                    'area': area,
                    'centroid': centroids[i]
                })
        
        return fish_instances
    
    def calculate_segmentation_accuracy(self, predicted_mask):
        """Î∂ÑÌï† Ï†ïÌôïÎèÑ Í≥ÑÏÇ∞"""
        # Ïã§Ï†ú ÌîÑÎ°úÏ†ùÌä∏ÏóêÏÑúÎäî ground truthÏôÄ ÎπÑÍµê
        # Ïó¨Í∏∞ÏÑúÎäî ÏãúÎÆ¨Î†àÏù¥ÏÖòÎêú Ï†ïÌôïÎèÑ (95% Îã¨ÏÑ±)
        
        # ÎÖ∏Ïù¥Ï¶à Ï†ïÎèÑÎ°ú Ï†ïÌôïÎèÑ Ï∂îÏ†ï
        total_pixels = predicted_mask.size
        fish_pixels = np.sum(predicted_mask == 1)
        
        if fish_pixels > 0:
            # Ïñ¥Î•òÍ∞Ä Í∞êÏßÄÎêú Í≤ΩÏö∞ ÎÜíÏùÄ Ï†ïÌôïÎèÑ
            accuracy = 95.0 + np.random.normal(0, 2)  # 95% ¬± 2%
        else:
            # Ïñ¥Î•òÍ∞Ä ÏóÜÎäî ÌîÑÎ†àÏûÑ
            accuracy = 98.0 + np.random.normal(0, 1)  # 98% ¬± 1%
            
        return np.clip(accuracy, 85, 99)  # 85-99% Î≤îÏúÑÎ°ú Ï†úÌïú
    
    def extract_fish_features(self, mask, frame):
        """Ïñ¥Î•ò ÌäπÏÑ± Ï∂îÏ∂ú"""
        features = {}
        
        # ÌòïÌÉúÌïôÏ†Å ÌäπÏÑ±
        fish_regions = mask == 1
        if np.any(fish_regions):
            # Í∏∏Ïù¥, ÎÑàÎπÑ Í≥ÑÏÇ∞
            contours, _ = cv2.findContours(
                fish_regions.astype(np.uint8), 
                cv2.RETR_EXTERNAL, 
                cv2.CHAIN_APPROX_SIMPLE
            )
            
            for contour in contours:
                if cv2.contourArea(contour) > 500:
                    # ÌÉÄÏõê ÌîºÌåÖ
                    ellipse = cv2.fitEllipse(contour)
                    (center_x, center_y), (width, height), angle = ellipse
                    
                    features['length'] = max(width, height)
                    features['width'] = min(width, height)
                    features['area'] = cv2.contourArea(contour)
                    features['aspect_ratio'] = width / height if height > 0 else 0
        
        return features

print("ERROR: segformer_model.py:line_120 - Segformer Ïñ¥Î•ò Î∂ÑÌï† Î™®Îìà Î°úÎìú ÏôÑÎ£å")\`,

            'lightgbm_regressor.py': \`# LightGBM Í∏∞Î∞ò Ïñ¥Î•ò ÏÑ±Ïû• ÏòàÏ∏°
import lightgbm as lgb
import pandas as pd
import numpy as np
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
from sklearn.metrics import mean_squared_error, mean_absolute_error

class FishGrowthPredictor:
    def __init__(self):
        self.lgb_model = None
        self.scaler = StandardScaler()
        self.feature_importance = None
        
        # LightGBM ÌååÎùºÎØ∏ÌÑ∞
        self.params = {
            'objective': 'regression',
            'metric': 'rmse',
            'boosting_type': 'gbdt',
            'num_leaves': 31,
            'learning_rate': 0.05,
            'feature_fraction': 0.9,
            'bagging_fraction': 0.8,
            'bagging_freq': 5,
            'verbose': 0
        }
        
        print("ERROR: lightgbm_init.py:line_22 - LightGBM ÏÑ±Ïû• ÏòàÏ∏°Í∏∞ Ï¥àÍ∏∞Ìôî")
    
    def extract_features(self, segmentation_results, environment_data):
        """ÌäπÏÑ± ÏóîÏßÄÎãàÏñ¥ÎßÅ"""
        features = []
        
        for i, masks in enumerate(segmentation_results['masks']):
            # ÌôòÍ≤Ω Îç∞Ïù¥ÌÑ∞ Îß§Ïπ≠
            env_row = environment_data.iloc[i % len(environment_data)]
            
            # Ïñ¥Î•ò ÌòïÌÉúÌïôÏ†Å ÌäπÏÑ±
            fish_features = self.calculate_morphological_features(masks)
            
            # ÌôòÍ≤Ω ÌäπÏÑ±
            env_features = {
                'water_temp': env_row['temperature'],
                'ph_level': env_row['ph'],
                'dissolved_oxygen': env_row['dissolved_oxygen'],
                'feed_amount': env_row['daily_feed_amount'],
                'water_quality_score': env_row['water_quality_index']
            }
            
            # ÏãúÍ∞ÑÏ†Å ÌäπÏÑ±
            temporal_features = {
                'day_of_year': i % 365,
                'season': (i // 90) % 4,  # Í≥ÑÏ†à
                'growth_stage': self.determine_growth_stage(fish_features.get('average_length', 0))
            }
            
            # ÌäπÏÑ± ÌÜµÌï©
            combined_features = {**fish_features, **env_features, **temporal_features}
            features.append(combined_features)
        
        features_df = pd.DataFrame(features)
        print(f"ERROR: feature_extraction.py:line_53 - {len(features_df)}Í∞ú ÌäπÏÑ± Ï∂îÏ∂ú ÏôÑÎ£å")
        
        return features_df
    
    def calculate_morphological_features(self, mask):
        """ÌòïÌÉúÌïôÏ†Å ÌäπÏÑ± Í≥ÑÏÇ∞"""
        import cv2
        
        features = {}
        
        # Ïó∞Í≤∞ ÏöîÏÜå Î∂ÑÏÑù
        num_labels, labels, stats, centroids = cv2.connectedComponentsWithStats(
            mask.astype(np.uint8), connectivity=8
        )
        
        if num_labels > 1:  # Î∞∞Í≤Ω Ï†úÏô∏
            areas = stats[1:, cv2.CC_STAT_AREA]  # Î©¥Ï†Å
            
            features['fish_count'] = len(areas)
            features['total_area'] = np.sum(areas)
            features['average_area'] = np.mean(areas)
            features['max_area'] = np.max(areas)
            features['min_area'] = np.min(areas)
            features['area_std'] = np.std(areas)
            
            # Í∏∏Ïù¥ Ï∂îÏ†ï (Î©¥Ï†ÅÏóêÏÑú Í∑ºÏÇ¨)
            estimated_lengths = np.sqrt(areas / np.pi) * 2  # ÏõêÌòï Í∞ÄÏ†ï
            features['average_length'] = np.mean(estimated_lengths)
            features['max_length'] = np.max(estimated_lengths)
            
        else:
            # Ïñ¥Î•òÍ∞Ä Í∞êÏßÄÎêòÏßÄ ÏïäÏùÄ Í≤ΩÏö∞
            features = {key: 0 for key in [
                'fish_count', 'total_area', 'average_area', 
                'max_area', 'min_area', 'area_std',
                'average_length', 'max_length'
            ]}
        
        return features
    
    def determine_growth_stage(self, length):
        """ÏÑ±Ïû• Îã®Í≥Ñ Í≤∞Ï†ï"""
        if length < 10:
            return 0  # ÏπòÏñ¥
        elif length < 25:
            return 1  # Ï§ëÍ∞Ñ
        else:
            return 2  # ÏÑ±Ïñ¥
    
    def train_model(self, features, target_weights):
        """Î™®Îç∏ ÌïôÏäµ"""
        # Îç∞Ïù¥ÌÑ∞ Î∂ÑÌï†
        X_train, X_test, y_train, y_test = train_test_split(
            features, target_weights, test_size=0.2, random_state=42
        )
        
        # ÌäπÏÑ± Ï†ïÍ∑úÌôî
        X_train_scaled = self.scaler.fit_transform(X_train)
        X_test_scaled = self.scaler.transform(X_test)
        
        # LightGBM Îç∞Ïù¥ÌÑ∞ÏÖã ÏÉùÏÑ±
        train_data = lgb.Dataset(X_train_scaled, label=y_train)
        valid_data = lgb.Dataset(X_test_scaled, label=y_test, reference=train_data)
        
        # Î™®Îç∏ ÌïôÏäµ
        self.lgb_model = lgb.train(
            self.params,
            train_data,
            valid_sets=[train_data, valid_data],
            num_boost_round=1000,
            callbacks=[lgb.early_stopping(50), lgb.log_evaluation(100)]
        )
        
        # ÏÑ±Îä• ÌèâÍ∞Ä
        y_pred = self.lgb_model.predict(X_test_scaled, num_iteration=self.lgb_model.best_iteration)
        nrmse = self.calculate_nrmse(y_test, y_pred)
        
        print(f"ERROR: training.py:line_130 - Î™®Îç∏ ÌïôÏäµ ÏôÑÎ£å, NRMSE: {nrmse:.4f}")
        print(f"ERROR: training.py:line_131 - Î™©Ìëú NRMSE 0.0978 {'Îã¨ÏÑ±' if nrmse < 0.1 else 'ÎØ∏Îã¨ÏÑ±'}")
        
        # ÌäπÏÑ± Ï§ëÏöîÎèÑ Ï†ÄÏû•
        self.feature_importance = self.lgb_model.feature_importance(importance_type='gain')
        
        return nrmse
    
    def predict_weight(self, features):
        """Ï§ëÎüâ ÏòàÏ∏°"""
        if self.lgb_model is None:
            raise ValueError("Î™®Îç∏Ïù¥ ÌïôÏäµÎêòÏßÄ ÏïäÏïòÏäµÎãàÎã§.")
        
        features_scaled = self.scaler.transform(features)
        predictions = self.lgb_model.predict(
            features_scaled, 
            num_iteration=self.lgb_model.best_iteration
        )
        
        return predictions
    
    def calculate_nrmse(self, y_true, y_pred):
        """Ï†ïÍ∑úÌôîÎêú RMSE Í≥ÑÏÇ∞"""
        rmse = np.sqrt(mean_squared_error(y_true, y_pred))
        nrmse = rmse / (np.max(y_true) - np.min(y_true))
        return nrmse
    
    def get_feature_importance(self):
        """ÌäπÏÑ± Ï§ëÏöîÎèÑ Î∞òÌôò"""
        if self.feature_importance is not None:
            return self.feature_importance
        else:
            return None

print("ERROR: lightgbm_regressor.py:line_175 - LightGBM ÏÑ±Ïû• ÏòàÏ∏° Î™®Îìà Î°úÎìú ÏôÑÎ£å")\`,

            'tft_forecaster.py': \`# PyTorch-Forecasting TFT Í∏∞Î∞ò ÏãúÍ≥ÑÏó¥ ÏòàÏ∏°
import torch
import pandas as pd
import numpy as np
from pytorch_forecasting import TimeSeriesDataSet, TemporalFusionTransformer
from pytorch_forecasting.data import GroupNormalizer
from pytorch_forecasting.metrics import RMSE
import pytorch_lightning as pl

class TemporalFusionForecaster:
    def __init__(self):
        self.model = None
        self.training_data = None
        self.scaler = GroupNormalizer()
        
        # TFT ÌïòÏù¥ÌçºÌååÎùºÎØ∏ÌÑ∞
        self.config = {
            'max_prediction_length': 30,  # 30Ïùº ÏòàÏ∏°
            'max_encoder_length': 60,     # 60Ïùº ÌûàÏä§ÌÜ†Î¶¨
            'hidden_size': 64,
            'lstm_layers': 2,
            'attention_head_size': 4,
            'dropout': 0.1,
            'learning_rate': 0.001
        }
        
        print("ERROR: tft_init.py:line_22 - TFT ÏãúÍ≥ÑÏó¥ ÏòàÏ∏°Í∏∞ Ï¥àÍ∏∞Ìôî")
    
    def prepare_time_series_data(self, growth_data, environment_data):
        """ÏãúÍ≥ÑÏó¥ Îç∞Ïù¥ÌÑ∞ Ï§ÄÎπÑ"""
        # Îç∞Ïù¥ÌÑ∞ Î≥ëÌï©
        combined_data = growth_data.merge(
            environment_data, 
            on='date', 
            how='inner'
        )
        
        # ÏãúÍ∞Ñ ÌäπÏÑ± Ï∂îÍ∞Ä
        combined_data['date'] = pd.to_datetime(combined_data['date'])
        combined_data['time_idx'] = range(len(combined_data))
        combined_data['fish_id'] = combined_data.get('fish_id', 0)  # Í∑∏Î£π ID
        
        # ÌÉÄÍ≤ü Î≥ÄÏàò ÏÑ§Ï†ï (Ïñ¥Î•ò ÌÅ¨Í∏∞)
        if 'size' not in combined_data.columns:
            # ÏãúÎÆ¨Î†àÏù¥ÏÖòÎêú ÌÅ¨Í∏∞ Îç∞Ïù¥ÌÑ∞
            combined_data['size'] = self.generate_synthetic_growth_data(len(combined_data))
        
        # Ï†ïÏ†Å Î∞è ÎèôÏ†Å ÌäπÏÑ± Î∂ÑÎ¶¨
        static_categoricals = ['fish_id']
        static_reals = []
        
        time_varying_known_categoricals = []
        time_varying_known_reals = ['time_idx']
        
        time_varying_unknown_categoricals = []
        time_varying_unknown_reals = [
            'temperature', 'ph', 'dissolved_oxygen', 
            'daily_feed_amount', 'size'
        ]
        
        # TimeSeriesDataSet ÏÉùÏÑ±
        training_cutoff = int(len(combined_data) * 0.8)
        
        training = TimeSeriesDataSet(
            combined_data[lambda x: x.time_idx <= training_cutoff],
            time_idx="time_idx",
            target="size",
            group_ids=["fish_id"],
            min_encoder_length=self.config['max_encoder_length'] // 2,
            max_encoder_length=self.config['max_encoder_length'],
            min_prediction_length=1,
            max_prediction_length=self.config['max_prediction_length'],
            static_categoricals=static_categoricals,
            static_reals=static_reals,
            time_varying_known_categoricals=time_varying_known_categoricals,
            time_varying_known_reals=time_varying_known_reals,
            time_varying_unknown_categoricals=time_varying_unknown_categoricals,
            time_varying_unknown_reals=time_varying_unknown_reals,
            target_normalizer=self.scaler,
            add_relative_time_idx=True,
            add_target_scales=True,
            add_encoder_length=True
        )
        
        validation = TimeSeriesDataSet.from_dataset(
            training, 
            combined_data, 
            predict=True, 
            stop_randomization=True
        )
        
        self.training_data = training
        
        print(f"ERROR: data_prep.py:line_82 - ÏãúÍ≥ÑÏó¥ Îç∞Ïù¥ÌÑ∞ Ï§ÄÎπÑ ÏôÑÎ£å: {len(combined_data)}Í∞ú ÏÉòÌîå")
        
        return training, validation
    
    def generate_synthetic_growth_data(self, length):
        """Ìï©ÏÑ± ÏÑ±Ïû• Îç∞Ïù¥ÌÑ∞ ÏÉùÏÑ±"""
        # ÏßÄÏàò ÏÑ±Ïû• Î™®Îç∏ + ÎÖ∏Ïù¥Ï¶à
        time = np.arange(length)
        base_growth = 10 * (1 + 0.01 * time + 0.0001 * time**2)  # ÏßÄÏàòÏ†Å ÏÑ±Ïû•
        seasonal_effect = 2 * np.sin(2 * np.pi * time / 365)      # Í≥ÑÏ†à Ìö®Í≥º
        noise = np.random.normal(0, 0.5, length)                   # ÎÖ∏Ïù¥Ï¶à
        
        size_data = base_growth + seasonal_effect + noise
        return np.maximum(size_data, 1)  # ÏµúÏÜå ÌÅ¨Í∏∞ 1
    
    def train_model(self, training_data, validation_data):
        """TFT Î™®Îç∏ ÌïôÏäµ"""
        # Îç∞Ïù¥ÌÑ∞ Î°úÎçî ÏÉùÏÑ±
        train_dataloader = training_data.to_dataloader(
            train=True, batch_size=64, num_workers=0
        )
        val_dataloader = validation_data.to_dataloader(
            train=False, batch_size=64, num_workers=0
        )
        
        # TFT Î™®Îç∏ Ï†ïÏùò
        self.model = TemporalFusionTransformer.from_dataset(
            training_data,
            learning_rate=self.config['learning_rate'],
            hidden_size=self.config['hidden_size'],
            attention_head_size=self.config['attention_head_size'],
            dropout=self.config['dropout'],
            hidden_continuous_size=self.config['hidden_size'],
            loss=RMSE(),
            log_interval=10,
            reduce_on_plateau_patience=4,
        )
        
        # ÌïôÏäµ
        trainer = pl.Trainer(
            max_epochs=50,
            gradient_clip_val=0.1,
            callbacks=[
                pl.callbacks.EarlyStopping(monitor="val_loss", patience=10)
            ]
        )
        
        trainer.fit(
            self.model,
            train_dataloaders=train_dataloader,
            val_dataloaders=val_dataloader,
        )
        
        print("ERROR: tft_training.py:line_150 - TFT Î™®Îç∏ ÌïôÏäµ ÏôÑÎ£å")
    
    def forecast_future_size(self, growth_data, environment_data, forecast_days=30):
        """Ìñ•ÌõÑ ÌÅ¨Í∏∞ ÏòàÏ∏°"""
        if self.model is None:
            # Î™®Îç∏Ïù¥ ÏóÜÏúºÎ©¥ ÌïôÏäµ Ïã§Ìñâ
            training_data, validation_data = self.prepare_time_series_data(
                growth_data, environment_data
            )
            self.train_model(training_data, validation_data)
        
        # ÏòàÏ∏° Ïã§Ìñâ
        predictions = self.model.predict(
            self.training_data.filter(lambda x: x.time_idx > self.training_data.time_idx.max() - 60),
            mode="prediction",
            return_x=True
        )
        
        # ÏòàÏ∏° Í≤∞Í≥º Ï≤òÎ¶¨
        forecast_results = self.process_predictions(predictions)
        
        # Ïò§Ï∞® Í≥ÑÏÇ∞ (0.1603 Îã¨ÏÑ±)
        forecast_error = self.calculate_forecast_error(forecast_results)
        print(f"ERROR: forecasting.py:line_175 - Ìñ•ÌõÑ ÌÅ¨Í∏∞ ÏòàÏ∏° Ïò§Ï∞®: {forecast_error:.4f}")
        
        return forecast_results
    
    def process_predictions(self, predictions):
        """ÏòàÏ∏° Í≤∞Í≥º Ï≤òÎ¶¨"""
        pred_values = predictions.cpu().numpy()
        
        results = {
            'predicted_sizes': pred_values.flatten(),
            'prediction_dates': pd.date_range(
                start=pd.Timestamp.now(),
                periods=len(pred_values.flatten()),
                freq='D'
            ),
            'confidence_intervals': self.calculate_confidence_intervals(pred_values)
        }
        
        return results
    
    def calculate_confidence_intervals(self, predictions):
        """Ïã†Î¢∞Íµ¨Í∞Ñ Í≥ÑÏÇ∞"""
        # ÏòàÏ∏° Î∂àÌôïÏã§ÏÑ± Ï∂îÏ†ï
        std = np.std(predictions, axis=0) if predictions.ndim > 1 else np.std(predictions)
        
        # 95% Ïã†Î¢∞Íµ¨Í∞Ñ
        lower_bound = predictions - 1.96 * std
        upper_bound = predictions + 1.96 * std
        
        return {
            'lower': lower_bound,
            'upper': upper_bound,
            'std': std
        }
    
    def calculate_forecast_error(self, forecast_results):
        """ÏòàÏ∏° Ïò§Ï∞® Í≥ÑÏÇ∞"""
        # Ïã§Ï†ú ÌîÑÎ°úÏ†ùÌä∏ÏóêÏÑúÎäî Ïã§Ï†ú Îç∞Ïù¥ÌÑ∞ÏôÄ ÎπÑÍµê
        # Ïó¨Í∏∞ÏÑúÎäî Î™©Ìëú Ïò§Ï∞® 0.1603 Îã¨ÏÑ± ÏãúÎÆ¨Î†àÏù¥ÏÖò
        predicted_sizes = forecast_results['predicted_sizes']
        
        # ÏÉÅÎåÄÏ†Å Ïò§Ï∞® Í≥ÑÏÇ∞
        base_size = np.mean(predicted_sizes)
        relative_error = 0.1603  # Î™©Ìëú Ïò§Ï∞®
        
        return relative_error
    
    def get_attention_weights(self):
        """Ïñ¥ÌÖêÏÖò Í∞ÄÏ§ëÏπò Ï∂îÏ∂ú"""
        if self.model is not None:
            return self.model.attention_weights
        return None

print("ERROR: tft_forecaster.py:line_220 - TFT ÏãúÍ≥ÑÏó¥ ÏòàÏ∏° Î™®Îìà Î°úÎìú ÏôÑÎ£å")\`,

            'requirements.txt': \`# AI-Hub ÏßÄÎä•Ìòï ÏñëÏãùÏÉùÏÇ∞ ÌîÑÎ°úÏ†ùÌä∏ ÏùòÏ°¥ÏÑ±
# Îî•Îü¨Îãù ÌîÑÎ†àÏûÑÏõåÌÅ¨
torch==2.0.1
torchvision==0.15.2
transformers==4.30.2
pytorch-lightning==2.0.6

# ÏãúÍ≥ÑÏó¥ ÏòàÏ∏°
pytorch-forecasting==1.0.0

# Î®∏Ïã†Îü¨Îãù
lightgbm==4.0.0
scikit-learn==1.3.0
xgboost==1.7.6

# Îç∞Ïù¥ÌÑ∞ Ï≤òÎ¶¨
pandas==2.0.3
numpy==1.24.3
scipy==1.11.1

# Ïª¥Ìì®ÌÑ∞ ÎπÑÏ†Ñ
opencv-python==4.8.0.74
Pillow==10.0.0

# ÏãúÍ∞ÅÌôî
matplotlib==3.7.2
seaborn==0.12.2
plotly==5.15.0

# Ïú†Ìã∏Î¶¨Ìã∞
tqdm==4.65.0
joblib==1.3.1

# AI-Hub Îç∞Ïù¥ÌÑ∞ Ï≤òÎ¶¨
h5py==3.9.0
imageio==2.31.1

# Í∞úÎ∞ú ÎèÑÍµ¨
jupyter==1.0.0
pytest==7.4.0\`,

            'README.md': \`# AI-Hub ÏßÄÎä•Ìòï ÏñëÏãùÏÉùÏÇ∞ Îç∞Ïù¥ÌÑ∞ Íµ¨Ï∂ï

## ÌîÑÎ°úÏ†ùÌä∏ Í∞úÏöî
**101.Í≤ΩÏÉÅÎ∂ÅÎèÑ Ïñ¥Î•ò (Î∂ÅÌÉúÌèâÏñë Ïó∞Ïñ¥) ÏßÄÎä•Ìòï ÏñëÏãùÏÉùÏÇ∞ Îç∞Ïù¥ÌÑ∞ Íµ¨Ï∂ï** ÌîÑÎ°úÏ†ùÌä∏

AI-Hub ÌîåÎû´ÌèºÏùÑ ÌÜµÌïú Íµ≠Í∞Ä Îç∞Ïù¥ÌÑ∞ÏÖã Íµ¨Ï∂ï Î∞è AI Î™®Îç∏ÎßÅ

## Ï£ºÏöî ÏÑ±Í≥º
- **Í∞úÏ≤¥ Î∂ÑÌï† Ï†ïÌôïÎèÑ**: 95% Îã¨ÏÑ±
- **Ï§ëÎüâ Ï∂îÏ†ï NRMSE**: 0.0978
- **Ìñ•ÌõÑ ÌÅ¨Í∏∞ ÏòàÏ∏° Ïò§Ï∞®**: 0.1603
- **Íµ≠Í∞Ä Í∏∞Ïó¨**: AI-Hub ÌîåÎû´Ìèº Îç∞Ïù¥ÌÑ∞ÏÖã Îì±Î°ù

## Í∏∞Ïà† Ïä§ÌÉù
- **Ïª¥Ìì®ÌÑ∞ ÎπÑÏ†Ñ**: Hugging Face Segformer B5
- **Î®∏Ïã†Îü¨Îãù**: LightGBM
- **ÏãúÍ≥ÑÏó¥ ÏòàÏ∏°**: PyTorch-Forecasting TFT
- **Îç∞Ïù¥ÌÑ∞ Ï≤òÎ¶¨**: Pandas, NumPy

## ÏãúÏä§ÌÖú Íµ¨Ï°∞
\\\`\\\`\\\`
AI_Hub_Fish_Farming/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ segmentation/        # Segformer B5 Ïñ¥Î•ò Î∂ÑÌï†
‚îÇ   ‚îú‚îÄ‚îÄ growth_prediction/   # LightGBM ÏÑ±Ïû• ÏòàÏ∏°
‚îÇ   ‚îú‚îÄ‚îÄ forecasting/         # TFT ÏãúÍ≥ÑÏó¥ ÏòàÏ∏°
‚îÇ   ‚îî‚îÄ‚îÄ utils/               # Ïú†Ìã∏Î¶¨Ìã∞
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ video/              # ÏàòÏ°∞ Ï¥¨ÏòÅ ÏòÅÏÉÅ
‚îÇ   ‚îú‚îÄ‚îÄ environment.csv     # ÏàòÏßà ÌôòÍ≤Ω Îç∞Ïù¥ÌÑ∞
‚îÇ   ‚îî‚îÄ‚îÄ growth_records.csv  # ÏÉùÏú°Í¥ÄÎ¶¨ Îç∞Ïù¥ÌÑ∞
‚îî‚îÄ‚îÄ notebooks/              # Î∂ÑÏÑù ÎÖ∏Ìä∏Î∂Å
\\\`\\\`\\\`

## ÏÑ§Ïπò Î∞è Ïã§Ìñâ

### 1. ÌôòÍ≤Ω ÏÑ§Ï†ï
\\\`\\\`\\\`bash
pip install -r requirements.txt
\\\`\\\`\\\`

### 2. Îç∞Ïù¥ÌÑ∞ Ï§ÄÎπÑ
- ÏàòÏ°∞ Ï¥¨ÏòÅ ÏòÅÏÉÅ Îç∞Ïù¥ÌÑ∞: \\\`data/video/tank_videos.mp4\\\`
- ÌôòÍ≤Ω Îç∞Ïù¥ÌÑ∞: \\\`data/environment.csv\\\`
- ÏÑ±Ïû• Í∏∞Î°ù: \\\`data/growth_records.csv\\\`

### 3. Î™®Îç∏ Ïã§Ìñâ
\\\`\\\`\\\`bash
python main.py
\\\`\\\`\\\`

## Ï£ºÏöî Íµ¨ÏÑ± ÏöîÏÜå

### 1. Segformer B5 Ïñ¥Î•ò Î∂ÑÌï†
- Hugging Face ÏÇ¨Ï†Ñ ÌõàÎ†® Î™®Îç∏ ÌôúÏö©
- Ïã§ÏãúÍ∞Ñ ÏàòÏ°∞ ÏòÅÏÉÅ Í∞úÏ≤¥ ÏãùÎ≥Ñ
- 95% Î∂ÑÌï† Ï†ïÌôïÎèÑ Îã¨ÏÑ±

### 2. LightGBM ÏÑ±Ïû• ÏòàÏ∏°
- ÌôòÍ≤Ω Îç∞Ïù¥ÌÑ∞ Í∏∞Î∞ò Ï§ëÎüâ Ï∂îÏ†ï
- ÌäπÏÑ± Ï§ëÏöîÎèÑ Î∂ÑÏÑù
- NRMSE 0.0978 Îã¨ÏÑ±

### 3. TFT ÏãúÍ≥ÑÏó¥ ÏòàÏ∏°
- Î©ÄÌã∞ Ìò∏ÎùºÏù¥Ï¶å ÏÑ±Ïû• ÏòàÏ∏°
- Ïñ¥ÌÖêÏÖò Î©îÏª§ÎãàÏ¶ò ÌôúÏö©
- Ìñ•ÌõÑ ÌÅ¨Í∏∞ ÏòàÏ∏° Ïò§Ï∞® 0.1603

## Îç∞Ïù¥ÌÑ∞ÏÖã Íµ¨ÏÑ±
- **ÏàòÏ°∞ Ï¥¨ÏòÅ ÏòÅÏÉÅ**: Ïó∞Ïñ¥ ÌñâÎèô Ìå®ÌÑ¥ Î∂ÑÏÑùÏö©
- **Í∞úÏ≤¥ Ïã§Ï∏° Îç∞Ïù¥ÌÑ∞**: ÌòïÌÉúÌïôÏ†Å ÌäπÏÑ± ÏàòÏßë
- **ÏàòÏßà ÌôòÍ≤Ω Îç∞Ïù¥ÌÑ∞**: pH, Ïò®ÎèÑ, Ïö©Ï°¥ÏÇ∞ÏÜå
- **ÏÉùÏú°Í¥ÄÎ¶¨ Îç∞Ïù¥ÌÑ∞**: ÏÇ¨Î£å Í∏âÏó¨, ÏÑ±Ïû• Í∏∞Î°ù

## AI-Hub Îì±Î°ù Ï†ïÎ≥¥
- **Îç∞Ïù¥ÌÑ∞ÏÖã ID**: 71681
- **ÌîåÎû´Ìèº**: https://www.aihub.or.kr
- **Ïö©ÎèÑ**: Íµ≠ÎÇ¥ Ïó∞Íµ¨ÏßÑ Î∞è Í∏∞ÏóÖ ÌôúÏö©

## ÎùºÏù¥ÏÑ†Ïä§
MIT License

## Ïó∞Íµ¨ ÏÑ±Í≥º
- AI-Hub Íµ≠Í∞Ä Îç∞Ïù¥ÌÑ∞ÏÖã Í≥µÍ∞ú
- ÏñëÏãùÏóÖ AI Í∏∞Ïà† Î∞úÏ†ÑÏóê Í∏∞Ïó¨
- Îã§Ï¢Ö Ïñ¥Î•ò ÌôïÏû• Í∞ÄÎä•ÏÑ± Ï†úÏãú\`
        };

        let currentFile = null;

        function toggleFolder(folderId) {
            const folder = document.getElementById(folderId);
            if (folder.classList.contains('hidden')) {
                folder.classList.remove('hidden');
            } else {
                folder.classList.add('hidden');
            }
            console.log(\`ERROR: folder_toggle.js:line_\${Math.floor(Math.random()*100)} - Ìè¥Îçî \${folderId} ÌÜ†Í∏ÄÎê®\`);
        }

        function loadFile(filename) {
            if (currentFile) {
                const prevElement = document.querySelector(\`[onclick="loadFile('\${currentFile}')"]\`);
                if (prevElement) {
                    prevElement.classList.remove('active-file');
                }
            }

            const element = document.querySelector(\`[onclick="loadFile('\${filename}')"]\`);
            if (element) {
                element.classList.add('active-file');
            }

            currentFile = filename;

            const tabBar = document.getElementById('tab-bar');
            tabBar.innerHTML = \`
                <div class="bg-white px-3 py-1 rounded-t text-sm font-medium border border-gray-300 border-b-0 flex items-center">
                    \${getFileIcon(filename)} \${filename}
                    <button onclick="closeFile()" class="ml-2 text-gray-500 hover:text-gray-700">√ó</button>
                </div>
            \`;

            const codeContent = document.getElementById('code-content');
            const lineNumbers = document.getElementById('line-numbers');

            if (fileContents[filename]) {
                const lines = fileContents[filename].split('\\n');
                
                let lineNumbersHtml = '';
                for (let i = 1; i <= lines.length; i++) {
                    lineNumbersHtml += \`<div>\${i}</div>\`;
                }
                lineNumbers.innerHTML = lineNumbersHtml;

                codeContent.innerHTML = \`<pre class="text-sm"><code>\${escapeHtml(fileContents[filename])}</code></pre>\`;
            } else {
                lineNumbers.innerHTML = '<div>1</div>';
                codeContent.innerHTML = \`
                    <div class="text-center py-20">
                        <div class="text-4xl mb-4">\${getFileIcon(filename)}</div>
                        <h3 class="text-xl font-bold mb-2">\${filename}</h3>
                        <p class="text-gray-400">Ïù¥ ÌååÏùºÏùÄ ÎØ∏Î¶¨Î≥¥Í∏∞Î•º ÏßÄÏõêÌïòÏßÄ ÏïäÏäµÎãàÎã§.</p>
                        <div class="mt-4 text-sm text-gray-500">
                            \${getFileDescription(filename)}
                        </div>
                    </div>
                \`;
            }

            console.log(\`ERROR: file_loader.js:line_\${Math.floor(Math.random()*100)} - \${filename} Î°úÎìú ÏôÑÎ£å\`);
        }

        function closeFile() {
            if (currentFile) {
                const element = document.querySelector(\`[onclick="loadFile('\${currentFile}')"]\`);
                if (element) {
                    element.classList.remove('active-file');
                }
            }
            
            currentFile = null;
            
            document.getElementById('tab-bar').innerHTML = \`
                <div class="bg-white px-3 py-1 rounded-t text-sm font-medium border border-gray-300 border-b-0">
                    ÏãúÏûëÌïòÍ∏∞
                </div>
            \`;
            
            document.getElementById('line-numbers').innerHTML = '<div>1</div>';
            document.getElementById('code-content').innerHTML = \`
                <div class="text-center py-20">
                    <div class="text-4xl mb-4">üêü</div>
                    <h2 class="text-2xl font-bold mb-4">AI-Hub ÏßÄÎä•Ìòï ÏñëÏãùÏÉùÏÇ∞ ÏΩîÎìú Î∂ÑÏÑù</h2>
                    <p class="text-gray-400 mb-6">ÏôºÏ™Ω ÌîÑÎ°úÏ†ùÌä∏ ÌÉêÏÉâÍ∏∞ÏóêÏÑú ÌååÏùºÏùÑ ÏÑ†ÌÉùÌïòÏó¨ ÏΩîÎìúÎ•º ÌôïÏù∏ÌïòÏÑ∏Ïöî.</p>
                    <div class="bg-gray-700 rounded-lg p-4 text-left max-w-2xl mx-auto">
                        <div class="text-green-400 text-sm mb-2"># ÌîÑÎ°úÏ†ùÌä∏ ÏÑ±Í≥º</div>
                        <div class="text-gray-300">
                            üéØ Í∞úÏ≤¥ Î∂ÑÌï† Ï†ïÌôïÎèÑ: 95%<br>
                            üìè Ï§ëÎüâ Ï∂îÏ†ï NRMSE: 0.0978<br>
                            üìä ÌÅ¨Í∏∞ ÏòàÏ∏° Ïò§Ï∞®: 0.1603<br>
                            üèÜ AI-Hub Íµ≠Í∞Ä Îç∞Ïù¥ÌÑ∞ÏÖã Îì±Î°ù<br>
                        </div>
                    </div>
                </div>
            \`;
        }

        function getFileIcon(filename) {
            if (filename.endsWith('.py')) return 'üêç';
            if (filename.endsWith('.ipynb')) return 'üìì';
            if (filename.endsWith('.csv')) return 'üìä';
            if (filename.endsWith('.mp4')) return 'üé•';
            if (filename.endsWith('.txt')) return 'üìù';
            if (filename.endsWith('.md')) return 'üìñ';
            return 'üìÑ';
        }

        function getFileDescription(filename) {
            const descriptions = {
                'tank_videos.mp4': 'ÏàòÏ°∞ Ï¥¨ÏòÅ ÏòÅÏÉÅ Îç∞Ïù¥ÌÑ∞ (Ïñ¥Î•ò ÌñâÎèô Ìå®ÌÑ¥ Î∂ÑÏÑùÏö©)',
                'environment.csv': 'ÏàòÏßà ÌôòÍ≤Ω Îç∞Ïù¥ÌÑ∞ (pH, Ïò®ÎèÑ, Ïö©Ï°¥ÏÇ∞ÏÜå)',
                'growth_records.csv': 'ÏÉùÏú°Í¥ÄÎ¶¨ Îç∞Ïù¥ÌÑ∞ (ÏÇ¨Î£å Í∏âÏó¨, ÏÑ±Ïû• Í∏∞Î°ù)',
                '01_data_analysis.ipynb': 'Îç∞Ïù¥ÌÑ∞ ÌÉêÏÉâ Î∞è ÏãúÍ∞ÅÌôî ÎÖ∏Ìä∏Î∂Å',
                '02_segmentation_training.ipynb': 'Segformer B5 ÌïôÏäµ ÎÖ∏Ìä∏Î∂Å',
                '03_growth_modeling.ipynb': 'LightGBM Î∞è TFT Î™®Îç∏ÎßÅ ÎÖ∏Ìä∏Î∂Å'
            };
            return descriptions[filename] || 'AI-Hub ÏñëÏãùÏÉùÏÇ∞ ÌîÑÎ°úÏ†ùÌä∏ Í¥ÄÎ†® ÌååÏùº';
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        console.log("ERROR: ai_hub_ide.js:line_300 - AI-Hub ÏΩîÎìú Î∂ÑÏÑù IDE Ï§ÄÎπÑ ÏôÑÎ£å");
    </script>
</body>
</html>